= Documentation Technique - Application IoT
:toc: left
:toc-title: Table des matières
:sectnums:
:imagesdir: images

== 1. Présentation de l'application

=== 1.1. Description générale
L'application IoT est un système de surveillance en temps réel permettant de :
- Visualiser les données des panneaux solaires Solaredge
- Monitorer les capteurs (température, humidité, CO2, activité)
- Configurer les paramètres de connexion MQTT
- Afficher les données en temps réel et historiques

=== 1.2. Use Case global
[plantuml]
----
@startuml
left to right direction
actor "Utilisateur" as user
actor "Administrateur" as admin

rectangle "Application IoT" {
    usecase "Visualiser données panneaux" as UC1
    usecase "Consulter capteurs" as UC2
    usecase "Configurer MQTT" as UC3
    usecase "Définir fréquence" as UC4
}

user --> UC1
user --> UC2
admin --> UC3
admin --> UC4
@enduml
----

== 2. Architecture

=== 2.1. Architecture générale
L'application suit une architecture MVC avec 3 couches distinctes :

- *Présentation* : Interface JavaFX
- *Métier* : Logique applicative Java + Script Python MQTT
- *Données* : Fichiers JSON de configuration et données

=== 2.2. Ressources externes
[cols="1,2,2"]
|===
|Technologie |Version |Usage

|JavaFX |17.0.2 |Framework IHM
|Eclipse Paho |1.2.5 |Client MQTT Python
|Jackson |2.13.0 |Parsing JSON
|===

=== 2.3. Structure des packages

* *application*
** *control* : Contrôleurs principaux
*** ConfigController : Gestion configuration
*** PanneauxController : Gestion panneaux
*** CapteursController : Gestion capteurs
** *view* : Vues FXML et contrôleurs associés
** *model* : Classes métier et accès données

== 3. Fonctionnalités détaillées

=== 3.1. Configuration MQTT
*Classes impliquées :*
- ConfigController : Sauvegarde/lecture config
- ConfigViewController : Interface config

[source,java]
----
public void saveConfig(String mqttServer, String outputFrequence, 
                                            boolean capteursSelected, boolean solaredgeSelected, 
                                            List<String> variablesCapteur) {
        // Sauvegarde config
        // Lance script Python
        ProcessBuilder pb = new ProcessBuilder("python3", "prg.py");
        pythonProcess = pb.start();
}
----

=== 3.2. Visualisation temps réel
*Classes impliquées :*
- PanneauxViewController
- CapteursViewController 

*Fonctionnement :*
. Lecture périodique fichiers JSON
. Mise à jour TableView JavaFX
. Gestion des graphiques

== 4. Installation 

=== 4.1. Environnement développement
. Prérequis :
- JDK 11+
- Python 3.8+
- IDE Java (Eclipse/IntelliJ)

. Installation :
[source,bash]
----
# Install Python deps
pip install paho-mqtt

# Import project in IDE
git clone <repo>
cd IOT/Application
mvn install
----

=== 4.2. Déploiement
[source,bash]
----
# 1. Launch Python MQTT client
cd IOT/Python
python prg.py

# 2. Launch Java app
cd IOT/Application
java -jar target/iot-app.jar
----
